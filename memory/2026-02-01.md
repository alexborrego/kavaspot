# February 1, 2026

## Bula Board Development Notes

### Tech Stack
- Vite + React + TypeScript (migrated from Next.js)
- Supabase for data (bars, events, deals, bar_hours, event_categories)
- Leaflet for interactive map
- Plausible analytics
- GitHub Pages deployment

### Key Features Built
- **Map + Favorites**: Interactive Leaflet map with favorite bars
- **Onboarding Modal**: First-time users select favorite bars
- **Searchable List**: Bars with favorites at top, alphabetical below
- **Favorites Toggle**: ☆/★ button to switch between all/favorites only
- **Unified Feed**: Events and deals grouped by time (happening now, today, tomorrow, this week)

### Issues Fixed
1. Plausible analytics script placed correctly in head
2. "Hours vary" - bar_hours table was empty, created SQL to populate
3. iOS map issues - added proper event handling for mobile
4. Multiple TypeScript errors (viewMode type, unused imports)
5. Crash on "Continue" - added safety check for empty favorites

### Files Created
- `src/components/map/MapTab.tsx` - Interactive map component
- `src/components/modals/OnboardingModal.tsx` - Favorites selection modal
- `src/components/modals/BarModal.tsx` - Bar details modal
- `src/utils/barCoordinates.ts` - Placeholder lat/long with TODO to clean up
- `scripts/bar-hours-data.sql` - SQL to populate bar hours
- `scripts/events-deals-real-data.sql` - Events and deals from real bar websites

### Supabase Tables
- bars (with google_place_id for reference)
- events (with recurrence_days array, event_category_id)
- deals (with discount_type, discount_value, recurrence_days)
- event_categories (Live Music, Trivia, Open Mic, etc.)
- bar_hours (empty - needs data populated)

### Known Issues
1. bar_hours table is empty - times show "Hours vary"
2. Bar coordinates are placeholders in barCoordinates.ts - need real lat/long

### Deployment
- GitHub Pages: https://alexborrego.github.io/kavaspot/
- GitHub Actions workflow for automatic deploy on push

### Recent Fixes (Feb 1, Evening)
- **Onboarding modal crash**: Added safety check in UnifiedFeed.tsx - returns empty array if showFavoritesOnly is true but favorites is empty
- **Star button**: Now correctly opens onboarding modal via setShowOnboarding(true)
- **SQL duplicate key error**: Regenerated bar-hours-data.sql using exact slug matching (`WHERE slug = '...'`) instead of LIKE patterns to prevent duplicate key violations

